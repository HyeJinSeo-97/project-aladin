import{C as W}from"./ContainerC-DtrTQ_Qi.js";import{J,K,b as l,o,j as f,F as v,k as S,e as t,h as d,t as c,n as B,c as g,p as D,u as I,d as n,l as x,g as h,r as T,B as O,v as Q,w as G}from"./index-DAHzhZ54.js";import{a as X,m as Z}from"./main-C03e9AkR.js";import{u as F}from"./common-akxb_OoK.js";const ee=Z.APIS.SEARCH,te=e=>new Promise((s,m)=>{X.get(ee,e).then(u=>{const{errorCode:a}=u.data;a?m(u.data):s(u.data)}).catch(u=>{m(u)})}),ne=J("search",()=>({actions:{getSearchItem:s=>te(s).then(m=>m).catch(m=>{K.notice({type:"error",text:m.errorMessage||m.message})})}})),V=[{key:"All",title:"통합 검색"},{key:"Book",title:"국내 도서"},{key:"Foreign",title:"외국 도서"},{key:"Music",title:"음반"},{key:"DVD",title:"DVD"},{key:"Used",title:"중고샵"},{key:"Ebook",title:"전자책"}],oe=(e,s)=>{if(!(!e||!s))return 100-e/s*100},le=(e,s="-")=>{if(e)return new Date(e).getFullYear()+s+("0"+(new Date(e).getMonth()+1)).slice(-2)},se={__name:"BookReviewC",props:{customerReviewRank:{type:Number,default:0},size:{type:String,default:"default"},fontClass:{type:String,default:"text-red-darken-3"}},setup(e){return(s,m)=>{const u=l("v-icon");return o(),f("div",null,[e.customerReviewRank<1?(o(),f(v,{key:0},[(o(),f(v,null,S(5,a=>t(u,{key:a,icon:"mdi-star-outline",size:e.size},null,8,["size"])),64)),d("span",{class:B(["font-weight-bold",e.fontClass])}," ( "+c(e.customerReviewRank.toFixed(1))+" ) ",3)],64)):(o(),f(v,{key:1},[(o(!0),f(v,null,S(Math.floor(e.customerReviewRank),a=>(o(),f(v,{key:a},[a%2===0?(o(),g(u,{key:0,icon:"mdi-star",size:e.size},null,8,["size"])):D("",!0)],64))),128)),e.customerReviewRank%2>=1?(o(),g(u,{key:0,icon:"mdi-star-half",size:e.size},null,8,["size"])):D("",!0),d("span",{class:B(["font-weight-bold",e.fontClass])}," ( "+c(e.customerReviewRank.toFixed(1))+" ) ",3)],64))])}}},ae=["innerHTML"],ie={class:"font-weight-bold text-red-darken-3"},ce=d("span",null,"(5% 적립)",-1),re={class:"ml-2"},ue={__name:"BookSearchC",props:{book:{type:Object,default:()=>{}}},setup(e){const s=I(),m=a=>{if(!(!a||a===""))return a.split(">")[0]},u=a=>a.replaceAll(s.query.word,`<strong>${s.query.word}</strong>`);return(a,_)=>{const b=l("v-img"),p=l("router-link"),i=l("v-sheet"),y=l("v-icon"),k=l("v-btn"),w=l("v-card");return o(),g(w,{flat:"",class:"d-flex ga-8"},{default:n(()=>[t(i,{class:"d-flex"},{default:n(()=>[t(p,{to:"",class:"d-inline-block h-100",onClick:_[0]||(_[0]=C=>x(F)("Product",{isbn13:e.book.isbn13}))},{default:n(()=>[t(b,{src:e.book.cover,alt:"썸네일",width:"180",height:"225",class:"rounded"},null,8,["src"])]),_:1})]),_:1}),t(i,{class:"d-flex flex-column justify-space-between pb-1 w-100"},{default:n(()=>[d("div",null,[t(i,{class:"text-left font-size-1"},{default:n(()=>[h(" ["+c(m(e.book.categoryName))+"] ",1),t(p,{to:"",class:"custom-router-link",onClick:_[1]||(_[1]=C=>x(F)("Product",{isbn13:e.book.isbn13}))},{default:n(()=>[d("span",{innerHTML:u(e.book.title)},null,8,ae)]),_:1})]),_:1}),t(i,{width:"100%",class:"border text-left pa-2 mt-2 mb-3 bg-grey-lighten-5"},{default:n(()=>[e.book.description?(o(),f(v,{key:0},[h(c(e.book.description),1)],64)):(o(),f(v,{key:1},[h(" 해당 도서에 대한 설명이 존재하지 않습니다. ")],64))]),_:1}),t(i,{class:"d-flex flex-column ga-1"},{default:n(()=>[t(i,{class:"d-flex align-center justify-start ga-1 font-size-85"},{default:n(()=>[t(i,{"max-width":"50%",class:"text-left text-ellipse"},{default:n(()=>[h(c(e.book.author),1)]),_:1}),t(y,{icon:"mdi-dots-vertical",size:"small",color:"grey"}),t(i,null,{default:n(()=>[h(c(e.book.publisher),1)]),_:1}),t(y,{icon:"mdi-dots-vertical",size:"small",color:"grey"}),t(i,null,{default:n(()=>[h(c(x(le)(e.book.pubDate)),1)]),_:1})]),_:1}),t(i,{class:"text-left"},{default:n(()=>[t(i,{class:"d-inline-block my-divider pr-2 mr-2"},{default:n(()=>[d("span",null,c(e.book.priceStandard.toLocaleString())+"원",1),t(y,{icon:"mdi-arrow-right",size:"small"}),d("span",ie,c(e.book.priceSales.toLocaleString())+"원 ",1),d("span",null," ("+c(x(oe)(e.book.priceSales,e.book.priceStandard))+"% 할인) ",1)]),_:1}),t(i,{class:"d-inline-block"},{default:n(()=>[d("span",null,"마일리지 "+c(e.book.mileage.toLocaleString())+"원",1),ce]),_:1})]),_:1}),t(i,{class:"d-flex align-center"},{default:n(()=>[t(se,{"customer-review-rank":e.book.customerReviewRank,size:"x-small","font-class":"font-size-75 text-black",class:"pr-2 my-divider"},null,8,["customer-review-rank"]),d("p",re,"세일즈포인트 : "+c(e.book.salesPoint.toLocaleString()),1)]),_:1})]),_:1})]),t(i,{class:"d-flex ga-2"},{default:n(()=>[t(k,{size:"small",color:"pink"},{default:n(()=>[h("장바구니")]),_:1}),t(k,{size:"small",color:"red"},{default:n(()=>[h("바로구매")]),_:1})]),_:1})]),_:1})]),_:1})}}},de={class:"font-weight-bold font-size-1"},me={class:"my-3 font-size-1 text-grey-darken-1"},ye={__name:"SearchResultView",setup(e){const s=I(),m=ne(),{actions:u}=m,a=T(!1),_=O({All:void 0,Book:void 0,Foreign:void 0,Music:void 0,DVD:void 0,Used:void 0,Ebook:void 0}),b=T(V[0].key),p=()=>{if(s.query.word.trim()==="")return;a.value=!0;const y={Query:s.query.word};u.getSearchItem(y).then(k=>{console.log("[ INIT - res ]",k),k.length>0&&k.forEach(w=>{_[w.apiType]=w}),a.value=!1}).catch(()=>{})};p();const i=Q(()=>{const{query:y}=s;return y.word});return G(()=>s.query.word,y=>{console.log("[WATCH]",y),p()}),(y,k)=>{const w=l("v-card-title"),C=l("v-tab"),$=l("v-tabs"),q=l("v-card-subtitle"),E=l("v-icon"),L=l("v-sheet"),N=l("v-divider"),P=l("v-window-item"),U=l("v-window"),Y=l("v-card-text"),j=l("v-card");return o(),g(W,{overlay:a.value},{default:n(()=>[t(j,null,{default:n(()=>[t(w,{class:"text-left"},{default:n(()=>[d("span",de,"‘"+c(i.value)+"’ 검색 결과",1)]),_:1}),t(q,null,{default:n(()=>[t($,{modelValue:b.value,"onUpdate:modelValue":k[0]||(k[0]=r=>b.value=r),density:"compact"},{default:n(()=>[(o(!0),f(v,null,S(x(V),r=>(o(),g(C,{key:r.key,value:r.key,size:"small","min-width":"fit-content","slider-color":"grey-darken-2",class:"px-1 mr-2"},{default:n(()=>{var z,R;return[d("span",{class:B({"font-weight-bold text-grey-darken-2":b.value===r.key})},c(r.title)+"("+c((R=(z=_[r.key])==null?void 0:z.totalResults)==null?void 0:R.toLocaleString())+") ",3)]}),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(Y,null,{default:n(()=>[t(U,{modelValue:b.value,"onUpdate:modelValue":k[1]||(k[1]=r=>b.value=r)},{default:n(()=>[(o(!0),f(v,null,S(x(V),r=>(o(),g(P,{key:r.key,value:r.key},{default:n(()=>{var z;return[((z=_[r.key])==null?void 0:z.totalResults)===0?(o(),g(L,{key:0,"min-height":"50vh",class:"d-flex flex-column align-center justify-center"},{default:n(()=>[t(E,{color:"grey",icon:"mdi-magnify",size:"95"}),d("p",me," ‘"+c(i.value)+"’에 대한 검색 결과가 없습니다. ",1)]),_:1})):(o(),g(L,{key:1,class:"d-flex flex-column ga-6 mt-3"},{default:n(()=>{var R;return[(o(!0),f(v,null,S((R=_[r.key])==null?void 0:R.item,(A,H)=>{var M;return o(),f(v,{key:A.itemId},[t(ue,{book:A},null,8,["book"]),H<((M=_[r.key])==null?void 0:M.item.length)-1?(o(),g(N,{key:0})):D("",!0)],64)}),128))]}),_:2},1024))]}),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["overlay"])}}};export{ye as default};
