import{C as Y}from"./ContainerC-BW1h5EbL.js";import{J as H,K as W,u as M,b as l,o as r,c as g,d as t,e,l as b,h as m,g as k,t as c,j as p,F as x,r as R,B as J,v as K,w as O,k as V,n as Q,p as G}from"./index-BUSVDCl2.js";import{a as X}from"./api.config-B3K_0KBx.js";import{u as T}from"./common-C4FalbzV.js";import{a as Z,g as ee,_ as te}from"./book-BOS3RanN.js";const oe=o=>{const d="/search";return new Promise((f,y)=>{X.get(d,o).then(a=>{const{errorCode:i}=a.data;i?y(a.data):f(a.data)}).catch(a=>{y(a)})})},ne=H("search",()=>({apiActions:{getSearchItem:d=>oe(d).then(f=>f).catch(f=>{W.notice({type:"error",text:f.errorMessage||f.message})})}})),L=[{key:"All",title:"통합 검색"},{key:"Book",title:"국내 도서"},{key:"Foreign",title:"외국 도서"},{key:"Music",title:"음반"},{key:"DVD",title:"DVD"},{key:"Used",title:"중고샵"},{key:"Ebook",title:"전자책"}],le=["innerHTML"],ae={class:"font-weight-bold text-red-darken-3"},se=m("span",null,"(5% 적립)",-1),ce={class:"ml-2"},re={__name:"BookSearchC",props:{book:{type:Object,default:()=>{}}},setup(o){const d=M(),f=a=>{if(!(!a||a===""))return a.split(">")[0]},y=a=>a.replaceAll(d.query.word,`<strong>${d.query.word}</strong>`);return(a,i)=>{const v=l("v-img"),w=l("router-link"),n=l("v-sheet"),_=l("v-icon"),u=l("v-btn"),h=l("v-card");return r(),g(h,{flat:"",class:"d-flex ga-8"},{default:t(()=>[e(n,{class:"d-flex"},{default:t(()=>[e(w,{to:"",class:"d-inline-block h-100",onClick:i[0]||(i[0]=C=>b(T)("Product",{isbn13:o.book.isbn13}))},{default:t(()=>[e(v,{src:o.book.cover,alt:"썸네일",width:"180",height:"225",class:"rounded"},null,8,["src"])]),_:1})]),_:1}),e(n,{class:"d-flex flex-column justify-space-between pb-1 w-100"},{default:t(()=>[m("div",null,[e(n,{class:"text-left font-size-1"},{default:t(()=>[k(" ["+c(f(o.book.categoryName))+"] ",1),e(w,{to:"",class:"custom-router-link",onClick:i[1]||(i[1]=C=>b(T)("Product",{isbn13:o.book.isbn13}))},{default:t(()=>[m("span",{innerHTML:y(o.book.title)},null,8,le)]),_:1})]),_:1}),e(n,{width:"100%",class:"border text-left pa-2 mt-2 mb-3 bg-grey-lighten-5"},{default:t(()=>[o.book.description?(r(),p(x,{key:0},[k(c(o.book.description),1)],64)):(r(),p(x,{key:1},[k(" 해당 도서에 대한 설명이 존재하지 않습니다. ")],64))]),_:1}),e(n,{class:"d-flex flex-column ga-1"},{default:t(()=>[e(n,{class:"d-flex align-center justify-start ga-1 font-size-85"},{default:t(()=>[e(n,{"max-width":"50%",class:"text-left text-ellipse"},{default:t(()=>[k(c(o.book.author),1)]),_:1}),e(_,{icon:"mdi-dots-vertical",size:"small",color:"grey"}),e(n,null,{default:t(()=>[k(c(o.book.publisher),1)]),_:1}),e(_,{icon:"mdi-dots-vertical",size:"small",color:"grey"}),e(n,null,{default:t(()=>[k(c(b(Z)(o.book.pubDate)),1)]),_:1})]),_:1}),e(n,{class:"text-left"},{default:t(()=>[e(n,{class:"d-inline-block my-divider pr-2 mr-2"},{default:t(()=>[m("span",null,c(o.book.priceStandard.toLocaleString())+"원",1),e(_,{icon:"mdi-arrow-right",size:"small"}),m("span",ae,c(o.book.priceSales.toLocaleString())+"원 ",1),m("span",null," ("+c(b(ee)(o.book.priceSales,o.book.priceStandard))+"% 할인) ",1)]),_:1}),e(n,{class:"d-inline-block"},{default:t(()=>[m("span",null,"마일리지 "+c(o.book.mileage.toLocaleString())+"원",1),se]),_:1})]),_:1}),e(n,{class:"d-flex align-center"},{default:t(()=>[e(te,{"customer-review-rank":o.book.customerReviewRank,size:"x-small","font-class":"font-size-75 text-black",class:"pr-2 my-divider"},null,8,["customer-review-rank"]),m("p",ce,"세일즈포인트 : "+c(o.book.salesPoint.toLocaleString()),1)]),_:1})]),_:1})]),e(n,{class:"d-flex ga-2"},{default:t(()=>[e(u,{size:"small",color:"pink"},{default:t(()=>[k("장바구니")]),_:1}),e(u,{size:"small",color:"red"},{default:t(()=>[k("바로구매")]),_:1})]),_:1})]),_:1})]),_:1})}}},ie={class:"font-weight-bold font-size-1"},de={class:"my-3 font-size-1 text-grey-darken-1"},ve={__name:"SearchResultView",setup(o){const d=M(),f=ne(),{apiActions:y}=f,a=R(!1),i=J({All:void 0,Book:void 0,Foreign:void 0,Music:void 0,DVD:void 0,Used:void 0,Ebook:void 0}),v=R(L[0].key),w=()=>{if(d.query.word.trim()==="")return;a.value=!0;const _={Query:d.query.word};y.getSearchItem(_).then(u=>{console.log("[ INIT - res ]",u),u.length>0&&u.forEach(h=>{i[h.searchTarget]=h}),a.value=!1}).catch(()=>{})};w();const n=K(()=>{const{query:_}=d;return _.word});return O(()=>d.query.word,_=>{console.log("[WATCH]",_),w()}),(_,u)=>{const h=l("v-card-title"),C=l("v-tab"),$=l("v-tabs"),q=l("v-card-subtitle"),I=l("v-icon"),A=l("v-sheet"),N=l("v-divider"),U=l("v-window-item"),j=l("v-window"),E=l("v-card-text"),F=l("v-card");return r(),g(Y,{overlay:a.value},{default:t(()=>[e(F,null,{default:t(()=>[e(h,{class:"text-left"},{default:t(()=>[m("span",ie,"‘"+c(n.value)+"’ 검색 결과",1)]),_:1}),e(q,null,{default:t(()=>[e($,{modelValue:v.value,"onUpdate:modelValue":u[0]||(u[0]=s=>v.value=s),density:"compact"},{default:t(()=>[(r(!0),p(x,null,V(b(L),s=>(r(),g(C,{key:s.key,value:s.key,size:"small","min-width":"fit-content","slider-color":"grey-darken-2",class:"px-1 mr-2"},{default:t(()=>{var S,z;return[m("span",{class:Q({"font-weight-bold text-grey-darken-2":v.value===s.key})},c(s.title)+"("+c((z=(S=i[s.key])==null?void 0:S.totalResults)==null?void 0:z.toLocaleString())+") ",3)]}),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(E,null,{default:t(()=>[e(j,{modelValue:v.value,"onUpdate:modelValue":u[1]||(u[1]=s=>v.value=s)},{default:t(()=>[(r(!0),p(x,null,V(b(L),s=>(r(),g(U,{key:s.key,value:s.key},{default:t(()=>{var S;return[((S=i[s.key])==null?void 0:S.totalResults)===0?(r(),g(A,{key:0,"min-height":"50vh",class:"d-flex flex-column align-center justify-center"},{default:t(()=>[e(I,{color:"grey",icon:"mdi-magnify",size:"95"}),m("p",de," ‘"+c(n.value)+"’에 대한 검색 결과가 없습니다. ",1)]),_:1})):(r(),g(A,{key:1,class:"d-flex flex-column ga-6 mt-3"},{default:t(()=>{var z;return[(r(!0),p(x,null,V((z=i[s.key])==null?void 0:z.item,(B,P)=>{var D;return r(),p(x,{key:B.itemId},[e(re,{book:B},null,8,["book"]),P<((D=i[s.key])==null?void 0:D.item.length)-1?(r(),g(N,{key:0})):G("",!0)],64)}),128))]}),_:2},1024))]}),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["overlay"])}}};export{ve as default};
